<%= section_panel 'Monitors', :width => 'single', :position => 'left' do %>
	<%= ci_list(@monitors, :new_path => nil) do |builder, target| %>
	  <% builder.target link_to('', assembly_operations_environment_platform_path(@assembly, @environment, target)) %>
		  <% if @ops_events.attributes.has_key?(@instance.ciId.to_s) && @ops_events.attributes[@instance.ciId.to_s].attributes.has_key?(target.ciName) %>
			 	<% builder.icon "/images/events/open.png" %>
			  	<% builder.top target.ciAttributes.description %>
			  	<% builder.middle do %>
			  		<% @ops_events.attributes[@instance.ciId.to_s].attributes[target.ciName].each do |t| %>
			  			<%= "#{t.name} since #{t.at.to_s(:short_us)}" %>
			  		<% end %>
			  	<% end %>
		  <% else %>
		  	<% builder.icon "/images/events/normal.png" %>
		  	<% builder.top target.ciAttributes.description %>
		  	<% builder.middle "#{ActiveSupport::JSON.decode(target.ciAttributes.thresholds).size} thresholds OK" %>
		  <% end %>
		  <% builder.bottom "#{@ops_events.attributes.has_key?(@instance.ciId.to_s)}" %>
	<% end %>
<% end %>

<%= section_panel "Open Events", :id => 'events_open', :width => 'double', :position => 'right' do %>
	<%= debug @ops_events %>
<% end %>
