<% status = @platform.ciAttributes.autoreplace == 'true' ? 'enabled' : 'disabled'
   has_operations = has_operations?(@assembly.ciId)%>
<div class="marker">
  <%= status_marker('autoreplace', status, state_to_label(status)) %>
</div>
<div class="description">
  <ul>
    <li>
      <%= icon('time', ' ') %> Autoreplace <%= highlight(status) %>
      <%= time_ago_in_words(Time.at(@platform_detail.attributes[:attributes].autoreplace.updated/1000)) %>
    </li>
  </ul>
  <% if has_operations %>
    <ul class="status-actions">
      <% if status == 'enabled' %>
        <li><%= link_to(icon_button('arrow-left', 'Disable', ''), autoreplace_assembly_operations_environment_platform_path(@assembly, @environment, @platform, :status => 'disable'), :method => :put, :remote => true) %></li>
      <% else %>
        <li><%= link_to(icon_button('arrow-left', 'Enable', 'success'), autoreplace_assembly_operations_environment_platform_path(@assembly, @environment, @platform, :status => 'enable'), :method => :put, :remote => true) %></li>
      <% end %>
    </ul>
  <% end %>
  <br/>
  <%= section_panel 'Autoreplace Configuration', :width => 'full', :position => 'left' do %>
    <%= render('base/shared/edit_form',
               {:resource   => @platform,
                :content    => 'autoreplace_configuration',
                :form_url   => autoreplace_assembly_operations_environment_platform_path(@assembly, @environment, @platform),
                # :form_method => :put,
                :cancel_url => autoreplace_assembly_operations_environment_platform_path(@assembly, @environment, @platform)}) %>
  <% end %>
</div>
